module Sherlock
  module Malware
    module MacOS
      module Compiled # Scan compiled files
        class << self
          # Checks to see if a binary imports potentially bad calls from the LSSSharedFileList* APIS
          # todo Finished compiled than meta program this
          # if binary -> do something else -> other scan
          # detect if its a pkg, app etc. Could probably automate process monitoring as well
          def find_login_item_persistence(file)
            # same sbad trings as decompiled
            # invoke system('nm', 'files') -> returns list see if list has bad strings
            # list item example: U _LSSharedFileListCreate
          end
        end
      end
    end
  end
end
